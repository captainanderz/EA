<div class="container-fluid mt-4">
  <!-- Page Heading -->
  <div
    class="row d-flex align-items-center justify-content-between mb-5 pl-3 pr-3"
  >
    <div class="col-auto">
      <div class="col">
        <p class="mb-0">Settings/</p>
        <h3 class="mb-2">Subscription</h3>
      </div>
    </div>
  </div>
  <div class="col mb-5">
    <div class="row justify-content-start">
      <div class="row pl-3 pr-3 upload-info">
        <div class="col-12 d-flex align-items-center">
          <div
            class="square-image-wrapper mr-2 d-none d-xl-inline"
            style="height: 64px"
          >
            <img *ngIf="logoImage" class="square-image" [src]="logoImage" />
            <svg
              *ngIf="!logoImage"
              xmlns="http://www.w3.org/2000/svg"
              fill="currentColor"
              class="bi bi-building p-1 h-100 w-100"
              viewBox="0 0 16 16"
            >
              <path
                fill-rule="evenodd"
                d="M14.763.075A.5.5 0 0 1 15 .5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V14h-1v1.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V10a.5.5 0 0 1 .342-.474L6 7.64V4.5a.5.5 0 0 1 .276-.447l8-4a.5.5 0 0 1 .487.022zM6 8.694 1 10.36V15h5V8.694zM7 15h2v-1.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 .5.5V15h2V1.309l-7 3.5V15z"
              />
              <path
                d="M2 11h1v1H2v-1zm2 0h1v1H4v-1zm-2 2h1v1H2v-1zm2 0h1v1H4v-1zm4-4h1v1H8V9zm2 0h1v1h-1V9zm-2 2h1v1H8v-1zm2 0h1v1h-1v-1zm2-2h1v1h-1V9zm0 2h1v1h-1v-1zM8 7h1v1H8V7zm2 0h1v1h-1V7zm2 0h1v1h-1V7zM8 5h1v1H8V5zm2 0h1v1h-1V5zm2 0h1v1h-1V5zm0-2h1v1h-1V3z"
              />
            </svg>
          </div>

          <div>
            <input
              style="display: none"
              type="file"
              accept="image/png, image/jpeg"
              (change)="onLogoSelected($event)"
              #logoFileInput
            />
            <a
              [routerLink]=""
              class="d-flex align-items-center mb-3"
              (click)="logoFileInput.click()"
            >
              <div class="icon">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="20"
                  height="20"
                  viewBox="0 0 40 40"
                >
                  <path
                    fill="#00baff"
                    fill-rule="evenodd"
                    d="M970.42,544.4l4.58-4.6v19.193a2,2,0,1,0,4,0V539.8l4.58,4.6a2,2,0,0,0,2.828.012l0.012-.012a2,2,0,0,0,.012-2.83l-0.012-.012-8-8a2.068,2.068,0,0,0-2.84,0l-8,8a2.009,2.009,0,0,0,2.84,2.842h0ZM995,552.989a2,2,0,0,0-2,2V567a2,2,0,0,1-2,2H963a2,2,0,0,1-2-2V554.99a2,2,0,1,0-4,0V567a6,6,0,0,0,6,6h28a6,6,0,0,0,6-6V554.99A2,2,0,0,0,995,552.989Z"
                    transform="translate(-957 -533)"
                  ></path>
                </svg>
              </div>
              <span class="photo-buttons-text">{{
                this.subscriptionDetailsDto.logoSmall == ""
                  ? "Add picture"
                  : "Replace picture"
              }}</span>
            </a>
            <a
              *ngIf="this.subscriptionDetailsDto.logoSmall != ''"
              [routerLink]=""
              class="d-flex align-items-center"
              (click)="deleteLogo(); logoFileInput.value = ''"
            >
              <div class="icon">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="18"
                  height="20"
                  viewBox="0 0 36 40"
                >
                  <path
                    fill="#ed1b65"
                    fill-rule="evenodd"
                    d="M993,620h-8v-2a6,6,0,0,0-6-6h-4a6,6,0,0,0-6,6v2h-8a2,2,0,0,0,0,4h2v22a6,6,0,0,0,6,6h16a6,6,0,0,0,6-6V624h2A2,2,0,0,0,993,620Zm-20-2a2,2,0,0,1,2-2h4a2,2,0,0,1,2,2v2h-8v-2Zm14,28a2,2,0,0,1-2,2H969a2,2,0,0,1-2-2V624h20v22Z"
                    transform="translate(-959 -612)"
                  ></path>
                </svg>
              </div>
              <span class="photo-buttons-text">Delete picture</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-lg-6 col-12 justify-content-end">
    <div class="form-group">
      <label for="groupPrefix" class="h4">Shop group prefix</label>
      <div class="input-group mb-3">
        <input
          type="text"
          class="form-control"
          aria-describedby="basic-addon2"
          [(ngModel)]="subscriptionDetailsDto.shopGroupPrefix"
        />
        <div class="input-group-append">
          <button
            class="btn btn-primary"
            type="button"
            (click)="updateShopGroupPrefix()"
          >
            Save
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="divider mt-5 mb-5"></div>

  <div
    class="row d-flex justify-content-between mb-5 pl-3 pr-3 subscription-details"
  >
    <div class="col-lg-6">
      <h4 class="mb-3">Subscription plan</h4>
      <div class="card grey-bg p-4 mb-4">
        <div class="card-header d-xl-flex justify-content-between">
          <div class="d-flex align-items-center mb-3">
            <div
              class="icon-circle logo d-flex align-items-center justify-content-center mr-3"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="34"
                height="30"
                viewBox="0 0 68 60"
              >
                <defs>
                  <style>
                    .logo-cls-1 {
                      fill: #00baff;
                    }

                    .logo-cls-2 {
                      opacity: 0.64;
                      mix-blend-mode: overlay;
                    }

                    .logo-cls-3 {
                      fill: #00114a;
                      fill-rule: evenodd;
                    }
                  </style>
                </defs>
                <circle class="logo-cls-1" cx="38" cy="30" r="30"></circle>
                <circle class="logo-cls-2" cx="38" cy="30" r="23"></circle>
                <path
                  class="logo-cls-3"
                  d="M45.995,76.9c3.378-2.675,6.941-3.311,11.741,2.854a16.036,16.036,0,0,0,1.349,1.556,15.6,15.6,0,0,0,22.3,0,16.168,16.168,0,0,0,0-22.627,15.6,15.6,0,0,0-22.3,0,16.09,16.09,0,0,0-1.349,1.556c-4.8,6.165-8.363,5.529-11.741,2.854a8.565,8.565,0,0,0-11.478.69,8.879,8.879,0,0,0,0,12.425A8.565,8.565,0,0,0,45.995,76.9Z"
                  transform="translate(-32 -40)"
                ></path>
                <circle class="logo-cls-1" cx="38" cy="30" r="6"></circle>
              </svg>
            </div>
            <div>
              <p class="info">
                {{ getStateDisplayName(subscriptionDetailsDto.state) }}
              </p>
              <p *ngIf="subscriptionDetailsDto.deviceCount">
                {{ subscriptionDetailsDto.deviceCount }}
                {{
                  subscriptionDetailsDto.deviceCount === 1
                    ? "Endpoint"
                    : "Endpoints"
                }}
              </p>
            </div>
          </div>
          <div class="text-xl-right mb-3">
            <ng-container
              *ngIf="
                subscriptionDetailsDto.state === subscriptionState.Trial ||
                subscriptionDetailsDto.state === subscriptionState.Cancelled
              "
            >
              <h4>{{ subscriptionDetailsDto.daysUntilPayment }} days</h4>
              <p>remaining</p>
            </ng-container>
            <ng-container
              *ngIf="subscriptionDetailsDto.state === subscriptionState.Active"
            >
              <h4>{{ subscriptionDetailsDto.dueAmount }}€</h4>
              <p>/ month</p>
            </ng-container>
          </div>
        </div>
        <div class="card-body d-flex align-items-end">
          <div
            class="d-xl-flex align-items-center justify-content-between w-100"
          >
            <div class="mb-xl-0 mb-3">
              <p>
                {{
                  subscriptionDetailsDto.state === subscriptionState.Trial
                    ? "First"
                    : "Next"
                }}
                payment
              </p>
              <p class="large">
                <ng-container
                  *ngIf="
                    subscriptionDetailsDto.state === subscriptionState.Trial ||
                      subscriptionDetailsDto.state === subscriptionState.Active;
                    else elseNextPayment
                  "
                >
                  {{ subscriptionDetailsDto.dueAmount }}€ on
                  {{ subscriptionDetailsDto.dueDate | date : "dd/MM/yyyy" }}
                </ng-container>
                <ng-template #elseNextPayment>Not applicable</ng-template>
              </p>
            </div>
            <button
              class="btn btn-outline-primary w-info"
              *ngIf="
                subscriptionDetailsDto.state === subscriptionState.Trial ||
                subscriptionDetailsDto.state === subscriptionState.Active
              "
              (click)="cancelSubscription()"
            >
              Cancel subscription
            </button>
            <button
              class="btn btn-outline-primary w-info"
              *ngIf="
                subscriptionDetailsDto.state === subscriptionState.Cancelled
              "
              (click)="reactivateSubscription()"
            >
              Reactivate subscription
            </button>
          </div>
        </div>
      </div>
    </div>
    <div class="col-lg-6">
      <h4 class="mb-3">Payment method</h4>
      <div class="card grey-bg p-4 mb-4 container">
        <div class="card-header">
          <div class="row justify-content-between">
            <div class="col-auto d-flex mb-3 mb-lg-0">
              <div
                class="icon-circle d-flex align-items-center justify-content-center mr-3"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                >
                  <path
                    fill="#00baff"
                    d="M20,2H10A3,3,0,0,0,7,5v7a3,3,0,0,0,3,3H20a3,3,0,0,0,3-3V5A3,3,0,0,0,20,2Zm1,10a1,1,0,0,1-1,1H10a1,1,0,0,1-1-1V5a1,1,0,0,1,1-1H20a1,1,0,0,1,1,1ZM17.5,8a1.49,1.49,0,0,0-1,.39,1.5,1.5,0,1,0,0,2.22A1.5,1.5,0,1,0,17.5,8ZM16,17a1,1,0,0,0-1,1v1a1,1,0,0,1-1,1H4a1,1,0,0,1-1-1V15H4a1,1,0,0,0,0-2H3V12a1,1,0,0,1,1-1A1,1,0,0,0,4,9a3,3,0,0,0-3,3v7a3,3,0,0,0,3,3H14a3,3,0,0,0,3-3V18A1,1,0,0,0,16,17ZM6,18H7a1,1,0,0,0,0-2H6a1,1,0,0,0,0,2Z"
                  ></path>
                </svg>
              </div>
              <div>
                <p>Credit card</p>
                <p class="info" *ngIf="subscriptionDetailsDto.creditCardDigits">
                  •••• •••• ••••
                  {{ subscriptionDetailsDto.creditCardDigits }}
                </p>
                <p
                  class="info"
                  *ngIf="!subscriptionDetailsDto.creditCardDigits"
                >
                  Not set up
                </p>
              </div>
            </div>

            <div class="col-auto">
              <button
                class="btn btn-outline-primary w-info"
                data-toggle="modal"
                data-target="#changePayment"
                (click)="redirectToFarPay()"
              >
                Change credit card
              </button>
            </div>
          </div>
        </div>
        <div class="card-body d-flex align-items-end">
          <div class="d-xl-flex align-items-end justify-content-between w-100">
            <div class="mb-xl-0 mb-3">
              <p>{{ subscriptionDetailsDto.companyName }}</p>
              <p>{{ subscriptionDetailsDto.city }}</p>
              <p>{{ subscriptionDetailsDto.country }}</p>
              <p>{{ subscriptionDetailsDto.zipCode }}</p>
              <p *ngIf="subscriptionDetailsDto.vatNumber">
                VAT no.: {{ subscriptionDetailsDto.vatNumber }}
              </p>
            </div>
            <button
              class="btn btn-outline-primary w-info"
              data-toggle="modal"
              data-target="#changeBilling"
              (click)="openBillingInformation()"
            >
              Change billing information
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div
    class="d-flex justify-content-start align-items-start ml-3 mb-0 position-absolute fixed-bottom"
  >
    <p class="mb-0">Version: {{ version }}</p>
  </div>
</div>
